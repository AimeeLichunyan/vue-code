{"version":3,"file":"vue.js","sources":["../../src/observer/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["// 数据观测的方法\r\nclass Observer {\r\n  constructor(value) {\r\n    //   使用defineProperty 重新定义属性\r\n    this.walk(value);\r\n  }\r\n  walk(data) {\r\n    let keys = Object.keys(data);\r\n    keys.forEach((key) => {\r\n      defineReactive(data, key, data[key]); // Vue.utils.defineReactive\r\n    });\r\n  }\r\n}\r\nfunction defineReactive(data, key, value) {\r\n  Object.defineProperty(data, key, {\r\n    get() {\r\n      console.log(\"get\");\r\n      return value;\r\n    },\r\n    set(newValue) {\r\n      console.log(\"set\");\r\n      if (newValue == value) return; // 如果新值和老值一样则不赋值操作\r\n      value = newValue;\r\n    },\r\n  });\r\n}\r\nexport default function observe(data) {\r\n  if (typeof data !== \"object\" && data === null) {\r\n    return;\r\n  }\r\n  return new Observer(data);\r\n}\r\n","import observe from \"./observer/index.js\";\r\n\r\n// 状态的初始化;\r\nexport function initSate(vm) {\r\n  // vue初始化的顺序就是：先初始化属性，在是方法，再是data\r\n  const opts = vm.$options;\r\n  if (opts.props) {\r\n    initProps(vm);\r\n  }\r\n  if (opts.methods) {\r\n    initMethods(vm);\r\n  }\r\n  //   核心部分\r\n  if (opts.data) {\r\n    initData(vm);\r\n  }\r\n  if (opts.computed) {\r\n    initComputed(vm);\r\n  }\r\n  if (opts.watch) {\r\n    initWatch(vm);\r\n  }\r\n}\r\nfunction initProps() {}\r\nfunction initMethods() {}\r\n\r\nfunction initData(vm) {\r\n  let data = vm.$options.data;\r\n  vm._data = data = typeof data == \"function\" ? data.call(vm) : data;\r\n  //   数据的劫持方案： 对象object.defineProperty\r\n  // 数组会单独处理\r\n  observe(data);\r\n}\r\nfunction initComputed() {}\r\nfunction initWatch() {}\r\n","import { initSate } from \"./state\";\r\n\r\nexport function initMixin(Vue) {\r\n  Vue.prototype._init = function (options) {\r\n    const vm = this;\r\n    vm.$options = options;\r\n\r\n    // 初始化状态（数据做初始化劫持，改变数据时应该更新视图）\r\n    //  vue 组件中很多状态，data,props,watch,computed\r\n    initSate(vm);\r\n\r\n    // vue核心特性：响应式数据原理\r\n    // Vue 是什么框架，MVVM（不完全是）怎么是？ 数据变化视图会更新，视图变化数据会被影响，\r\n    // 怎么不是？ mvvm不能跳过数据直接更新视图，但是vue有$ref可以直接操作dom\r\n  };\r\n}\r\n","import { initMixin } from \"./init\";\r\nfunction Vue(options) {\r\n  console.log(options);\r\n  this._init(options);\r\n}\r\n//写成一个个的插件进行扩展，解耦方法\r\n// vue初始化方法\r\ninitMixin(Vue);\r\nexport default Vue;\r\n"],"names":["Observer","value","walk","data","keys","Object","forEach","key","defineReactive","defineProperty","get","console","log","set","newValue","observe","initSate","vm","opts","$options","props","methods","initData","computed","watch","_data","call","initMixin","Vue","prototype","_init","options"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAA;MACMA;EACJ,oBAAYC,KAAZ,EAAmB;EAAA;;EACjB;EACA,SAAKC,IAAL,CAAUD,KAAV;EACD;;;;2BACIE,MAAM;EACT,UAAIC,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAYD,IAAZ,CAAX;EACAC,MAAAA,IAAI,CAACE,OAAL,CAAa,UAACC,GAAD,EAAS;EACpBC,QAAAA,cAAc,CAACL,IAAD,EAAOI,GAAP,EAAYJ,IAAI,CAACI,GAAD,CAAhB,CAAd,CADoB;EAErB,OAFD;EAGD;;;;;;EAEH,SAASC,cAAT,CAAwBL,IAAxB,EAA8BI,GAA9B,EAAmCN,KAAnC,EAA0C;EACxCI,EAAAA,MAAM,CAACI,cAAP,CAAsBN,IAAtB,EAA4BI,GAA5B,EAAiC;EAC/BG,IAAAA,GAD+B,iBACzB;EACJC,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ;EACA,aAAOX,KAAP;EACD,KAJ8B;EAK/BY,IAAAA,GAL+B,eAK3BC,QAL2B,EAKjB;EACZH,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ;EACA,UAAIE,QAAQ,IAAIb,KAAhB,EAAuB,OAFX;;EAGZA,MAAAA,KAAK,GAAGa,QAAR;EACD;EAT8B,GAAjC;EAWD;;EACc,SAASC,OAAT,CAAiBZ,IAAjB,EAAuB;EACpC,MAAI,QAAOA,IAAP,MAAgB,QAAhB,IAA4BA,IAAI,KAAK,IAAzC,EAA+C;EAC7C;EACD;;EACD,SAAO,IAAIH,QAAJ,CAAaG,IAAb,CAAP;EACD;;EC5BM,SAASa,QAAT,CAAkBC,EAAlB,EAAsB;EAC3B;EACA,MAAMC,IAAI,GAAGD,EAAE,CAACE,QAAhB;;EACA,MAAID,IAAI,CAACE,KAAT,EAAgB;;EAGhB,MAAIF,IAAI,CAACG,OAAT,EAAkB,CANS;;;EAU3B,MAAIH,IAAI,CAACf,IAAT,EAAe;EACbmB,IAAAA,QAAQ,CAACL,EAAD,CAAR;EACD;;EACD,MAAIC,IAAI,CAACK,QAAT,EAAmB;;EAGnB,MAAIL,IAAI,CAACM,KAAT,EAAgB;EAGjB;;EAID,SAASF,QAAT,CAAkBL,EAAlB,EAAsB;EACpB,MAAId,IAAI,GAAGc,EAAE,CAACE,QAAH,CAAYhB,IAAvB;EACAc,EAAAA,EAAE,CAACQ,KAAH,GAAWtB,IAAI,GAAG,OAAOA,IAAP,IAAe,UAAf,GAA4BA,IAAI,CAACuB,IAAL,CAAUT,EAAV,CAA5B,GAA4Cd,IAA9D,CAFoB;EAIpB;;EACAY,EAAAA,OAAO,CAACZ,IAAD,CAAP;EACD;;EC9BM,SAASwB,SAAT,CAAmBC,GAAnB,EAAwB;EAC7BA,EAAAA,GAAG,CAACC,SAAJ,CAAcC,KAAd,GAAsB,UAAUC,OAAV,EAAmB;EACvC,QAAMd,EAAE,GAAG,IAAX;EACAA,IAAAA,EAAE,CAACE,QAAH,GAAcY,OAAd,CAFuC;EAKvC;;EACAf,IAAAA,QAAQ,CAACC,EAAD,CAAR,CANuC;EASvC;EACA;EACD,GAXD;EAYD;;ECdD,SAASW,GAAT,CAAaG,OAAb,EAAsB;EACpBpB,EAAAA,OAAO,CAACC,GAAR,CAAYmB,OAAZ;;EACA,OAAKD,KAAL,CAAWC,OAAX;EACD;EAED;;;EACAJ,SAAS,CAACC,GAAD,CAAT;;;;;;;;"}