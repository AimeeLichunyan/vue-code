{"version":3,"file":"vue.js","sources":["../../src/compiler/generate.js","../../src/compiler/parse.js","../../src/compiler/index.js","../../src/vdom/patch.js","../../src/lifecycle.js","../../src/utils.js","../../src/observer/array.js","../../src/observer/index.js","../../src/state.js","../../src/init.js","../../src/vdom/index.js","../../src/index.js"],"sourcesContent":["const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\n\n// dom结构转换成js语法\nfunction genProps(attrs) {\n    let str = '';\n    for(let i = 0; i < attrs.length; i++) {\n        let attr = attrs[i];\n        if(attr.name === 'style') {\n            let obj = {};\n            attr.value.split(';').forEach(item => {\n                let [key,value] = item.split(':');\n                obj[key] = value\n            })\n            attr.value = obj\n        }\n        str += `${attr.name} : ${JSON.stringify(attr.value)},`\n    }\n    return `{${str.slice(0,-1)}}`\n\n}\nfunction gen(node) {\n    if(node.type == 1) {\n        return generate(node) // 生成元素节点的字符串\n    } else {\n        let text = node.text\n        // 如果是普通文本，不带{{}}\n        if(!defaultTagRE.test(text)) {\n        return `_v(${JSON.stringify(text)})`\n\n        }\n        let tokens = [];\n        let lastIndex = defaultTagRE.lastIndex = 0\n        let match,index;\n        while(match = defaultTagRE.exec(text)) {\n            index = match.index; // 保存匹配到的索引\n            if(index > lastIndex) {\n                tokens.push(JSON.stringify(text.slice(lastIndex,index)))\n            }\n            tokens.push(`_s(${match[1].trim()})`);\n            lastIndex = index + match[0].length\n        }\n        if(lastIndex < text.length) {\n            tokens.push(JSON.stringify(text.slice(lastIndex)))\n        }\n        return `_v(${tokens.join('+')})`\n    }\n}\nfunction getChildren(el) {\n    const children = el.children;\n    if(children) { // 将所有转化后的儿子，用逗号拼接\n        return children.map(child => gen(child)).join(',')\n    }\n}\nexport function generate(el) {\n    let children = getChildren(el)\n    let code= `_c('${el.tag}',${el.attrs.length?`${genProps(el.attrs)}`: 'undefined'}${children?`,${children}`:''})`\n\n    return code\n}   ","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // 标签名，比如<aa-aa></aa-aa>\n// ?匹配不捕获 my:xx \nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`;\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 标签开头的正则 捕获的内容是标签名\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾的 </div>\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的 >\n\n\nexport function parseHTML(html) {\n\n    function creatAstElement(tagName,attrs) {\n        return {\n            tag: tagName,\n            children: [],\n            attrs,\n            type: 1, //类型，本文还是标签\n            parent: null,// 父级元素\n        }\n    }\n    let root;\n    let currentParent;\n    let stack = []\n    // 校验标签是否合法\n    function start(tagName,attrs) {\n        let element = creatAstElement(tagName,attrs)\n        if(!root) {\n            root = element\n        }\n        currentParent = element\n        stack.push(element)\n    }\n    function end(tagName) { // 在结尾标签处，创建父子关系\n        let element = stack.pop(); //取出栈中的最后一个元素\n        currentParent = stack[stack.length - 1];\n        if(currentParent) { // 在闭合时，知道这个标签的父级是哪个\n            element.parent = currentParent\n            currentParent.children.push(element)\n        }\n    }\n    function chars(text) {\n        text = text.replace(/\\s/g,\"\");\n        if(text) {\n            currentParent.children.push({\n                type:3,\n                text\n            })\n        }\n    }\n\n\n\n    while(html) { //只要html不为空，则一直解析\n        let textEnd = html.indexOf('<') // indexOf如果没有返回-1，如果有返回元素的位置\n        if(textEnd == 0) {\n            const startTagMatch =  parseStartTag(); //开始标签匹配的结果\n            if(startTagMatch) {\n                start(startTagMatch.tagName,startTagMatch.attrs)\n                continue\n            }\n            const endTagMatch =  html.match(endTag)\n            if(endTagMatch) {\n                advance(endTagMatch[0].length);\n                end(endTagMatch[1]) // 将结束标签传入\n                continue\n            }\n        }\n        let text;\n        if(textEnd > 0) {// 如果是文本\n            text = html.substring(0,textEnd);\n        }\n        if(text) {\n            advance(text.length)\n            chars(text);\n        }\n        // break\n    }\n    function advance(n) { // 将字符串进行截取操作，再更新html内容\n        html = html.substring(n)\n    }\n    function parseStartTag() {\n        const start = html.match(startTagOpen);\n        if(start) {\n            const match = {\n                tagName: start[1],\n                attrs: []\n            }\n            advance(start[0].length) // 删除开始标签\n            // 如果是闭合标签，说明没有属性\n            let end ;\n            let attr\n            // 不是结束标签，能匹配到属性\n            while(!(end=html.match(startTagClose)) && (attr = html.match(attribute))) {\n                match.attrs.push({name: attr[1],value:attr[3] || attr[4]|| attr[5]})\n                advance(attr[0].length)\n            }\n            if(end) {\n                advance(end[0].length);\n                return match\n            }\n            // console.log(html)\n        }\n    }\n\n    return root;\n}\n","import { generate } from \"./generate\"\nimport { parseHTML } from \"./parse\"\n// <div id=\"my\">hello {{name}} <span>world</span> </div>\n// {\n//     tag: 'div',\n//     parent: null,\n//     type:1,\n//     attrs: [],\n//     children: [{\n//         tag:null,\n//         parent: div,父\n//     }]\n// }\n\nexport function compileToFunctions(template) {\n    // console.log(template)\n    // 将html模板 =》 render函数\n    // ast语法树\n    // 1.将html代码转化成ast语法树，可以用ast树描述语言本身\n    // 前端必须掌握的数据结构===树\n    // 优化静态节点\n    let ast = parseHTML(template)\n    // 2. 优化静态节点\n    // console.log(ast)\n    // 3. 通过ast树重新生成代码\n    let code= generate(ast)\n    console.log(code)\n    // 4. 将字符串转换成函数,限制取值范围，通过with来进行取值。调用render函数可以通过改变this，让这个函数内部渠道结果\n   let render  =  new Function(`with(this){return ${code}}`)\n\n    // console.log(render)\n    return render\n    // 虚拟dom是用对象来描述节点，ast也可以描述js余元\n\n    \n        \n\n}","export function patch(oldVnode,vnode) {\n    // 将虚拟节点转化成真是节点\n    // 递归生成\n    // oldVnode是dom结构中真是的挂载点，<div id=\"app\" style=\"color: red\"></div>\n    // vnode是产生的虚拟节点\n    console.log(oldVnode,vnode)\n    let el = createElm(vnode); // 将虚拟dom节点产生真实的dom结构\n    let parentElm = oldVnode.parentNode; // 获取老的app的父级节点body\n    parentElm.insertBefore(el,oldVnode.nextSibling); // 将当前的真实元素插入到app的后面\n    parentElm.removeChild(oldVnode) // 删除老的app节点，即开始的真是dom挂载点\n}\nfunction createElm(vnode) {\n    let {tag,children,key,data,text} = vnode;\n    if(typeof tag == 'string' ) { //创建元素，放到vnode.el上\n        vnode.el = document.createElement(tag);\n        console.log('children',children)\n        children.forEach(child => { // 遍历儿子，将儿子渲染后的结构扔到父亲中\n            vnode.el.appendChild(createElm(child))\n        })\n    }else { // 创建文件，放到vnode.el上\n        vnode.el = document.createTextNode(text)\n    }\n    return vnode.el\n}\n// vue的渲染流程 1.初始化数据 2. 将模板进行编译成render函数，生成虚拟节点，生成真是的dom，渲染到页面","import { patch } from \"./vdom/patch\"\n\nexport function lifecycleMixin(Vue) {\n    Vue.prototype._update = function(vnode) {\n        const vm= this\n        patch(vm.$el,vnode) // 比较重要的的方法，将虚拟节点创建为真实节点\n    }\n}\n\nexport function mountComponent(vm,el) {\n    // 调用render方法去渲染el属性\n\n\n    // 先调用render方法，创建虚拟节点，在将虚拟节点渲染到页面上\n    vm._update(vm._render())\n}","export function proxy(vm,data,key) {\n    Object.defineProperty(vm,key,{\n      get() {\n        return vm[data][key];\n      },\n      set(newValue) {\n        vm[data][key] = newValue\n      }\n    })\n  }\n  export function defineProperty(target,key,value) {\n    Object.defineProperty(target,key,{\n        enumerable:false, // 不能被，枚举，不能被循环出来\n        configurable:false,\n        value: value\n      })\n  }","// 拿到数组原型的方法（或者拿到数组原来的方法）\nlet oldArrayProtoMethods = Array.prototype;\n\n// 继承原来数组的方法 arrayMethods.__proto__ = oldArrayProtoMethods,继承以后可以重写，如果没有重写，则会顺着原型链找到原来数组的方法\nexport let arrayMethods = Object.create(oldArrayProtoMethods)\nlet methods = [\n    'push',\n    'pop',\n    'shift',\n    'unshift',\n    'reverse',\n    'sort',\n    'splice'\n]\n// 这是个高阶函数或者叫切片编程\nmethods.forEach(method => {\n    arrayMethods[method] = function(...args) { // this就是ob\n        const result = oldArrayProtoMethods[method].apply(this,arguments)\n        let inserted;\n        let ob = this.__ob__\n        switch (method) {\n            case 'push': // arr.push({a:1},{b:2})\n            case 'unshift': // push和unshift方法都是追加的,追加的内容可能是对象类型，应该再次进行劫持\n                inserted = args\n                break;\n            case 'splice': // vue.$set实现的原理就是splice，删除，添加，修改\n            inserted = args.slice(2) // arr.splice(0,1,{a:1})\n            default:\n                break;\n        }\n        if(inserted) ob.observeArray(inserted) // 给数组新增的值进行观测\n        return result\n    }\n})","import { defineProperty } from \"../utils\";\nimport { arrayMethods } from \"./array\";\n\n// 数据观测的方法\nclass Observer {\n  constructor(value) {\n    // 使用defineProperty重新定义属性，\n    // 判断一个对象是否被观测过，看它有没有__ob__这个属性\n    defineProperty(value,'__ob__',this)\n    \n    // 判断是否是数组\n    if(Array.isArray(value)) {\n      // 调用push，shift，unshift,splice,sort,reverse,pop等操作\n      // 函数劫持，或者切片编程\n      value.__proto__ = arrayMethods\n      // 观测数组中的对象类型，对象变化触发一些操作\n      this.observeArray(value)\n    }else {\n      //   使用defineProperty 重新定义属性\n    this.walk(value);\n    }\n    \n  }\n  observeArray(value) {\n    value.forEach(item => {\n      observe(item)\n    })\n  }\n  walk(data) {\n    let keys = Object.keys(data);\n    keys.forEach((key) => {\n      defineReactive(data, key, data[key]); // Vue.utils.defineReactive\n    });\n  }\n}\nfunction defineReactive(data, key, value) {// 为每一个对象添加defineProperty，getset函数，进行数据劫持\n  observe(value) // 递归进行检测，value是否是对象，只要对象层级比较深，就会不停的递归，影响性能，所以在vue3中使用proxy实现，vue3是懒递归\n  Object.defineProperty(data, key, { // 其实是一个闭包，当前作用域下data不销毁\n    get() {\n      console.log('q取值')\n      return value;\n    },\n    set(newValue) {\n      console.log('设置')\n      if (newValue == value) return; // 如果新值和老值一样则不赋值操作\n      observe(newValue) // 判断设置的新的值是不是对象，如果用户将值改为对象，则继续监控\n      value = newValue;\n    },\n  });\n}\nexport default function observe(data) {\n  if (typeof data !== \"object\" || data === null) {\n    return data;\n  }\n  if(data.__ob__) {\n    return data;\n  }\n  return new Observer(data); // 使用类的好处是方便识别当前这个属性属于哪个实例，只观测data中的数据\n  // 数组中的长度和索引如法被监控\n}\n","import observe from \"./observer/index.js\";\nimport { proxy } from \"./utils.js\";\n\n// 状态的初始化;\nexport function initSate(vm) {\n  // vue初始化的顺序就是：先初始化属性，在是方法，再是data\n  const opts = vm.$options;\n  if (opts.props) {\n    initProps(vm);\n  }\n  if (opts.methods) {\n    initMethods(vm);\n  }\n  //   核心部分\n  if (opts.data) {\n    initData(vm);\n  }\n  if (opts.computed) {\n    initComputed(vm);\n  }\n  if (opts.watch) {\n    initWatch(vm);\n  }\n}\nfunction initProps() {}\nfunction initMethods() {}\n\nfunction initData(vm) {\n  let data = vm.$options.data;\n  vm._data = data = typeof data == \"function\" ? data.call(vm) : data;\n  //   数据的劫持方案： 对象object.defineProperty\n  // 数组会单独处理\n\n  // 实现代理 -- 当我去vm上取值是，帮我将属性的取值代理大vm._data上\n  for(let key in data) {\n    proxy(vm,'_data',key)\n  }\n  observe(data);\n}\nfunction initComputed() {}\nfunction initWatch() {}\n","import { compileToFunctions } from \"./compiler/index\";\nimport { mountComponent } from \"./lifecycle\";\nimport { initSate } from \"./state\";\n\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    const vm = this;\n    vm.$options = options;\n\n    // 初始化状态（数据做初始化劫持，改变数据时应该更新视图）\n    //  vue 组件中很多状态，data,props,watch,computed\n    initSate(vm);\n\n    // vue核心特性：响应式数据原理\n    // Vue 是什么框架，MVVM（不完全是）怎么是？ 数据变化视图会更新，视图变化数据会被影响，\n    // 怎么不是？ mvvm不能跳过数据直接更新视图，但是vue有$ref可以直接操作dom\n    // 如果有el属性，说明要渲染模板\n    if(vm.$options.el) {\n      vm.$mount(vm.$options.el)\n    }\n  };\n  Vue.prototype.$mount = function(el) {\n    // 挂载操作\n    const vm = this;\n    const options = vm.$options;\n\n    el = document.querySelector(el);\n    vm.$el = el;\n    if(!options.render) {\n      // 没有render方法，将template转化成render方法\n      let template = options.template;\n      if(!template && el) { // 没有tamplatet，有el，直接采用外部模板，即我们平时的写法\n        template = el.outerHTML; // el.outerHTML拿到el所在的html元素\n      }\n      // 编译原理，将模板编译成render函数\n      const render = compileToFunctions(template); // 将dom结构编译成函数\n      options.render = render\n    }\n    // options.render\n    // console.log(options.render) // 渲染时用的都是这个render方法\n\n    // 需要挂载这个组件\n    mountComponent(vm,el)\n\n  }\n}\n","export function renderMixin(Vue) {\n    Vue.prototype._c = function() { //创建虚拟dom元素\n        return createElement(...arguments)\n    }\n    Vue.prototype._s = function(val) { // stringify\n        return val == null ? '' : (typeof val == 'object') ? JSON.stringify(val): val\n    }\n    Vue.prototype._v = function(text) { // 创建虚拟dom文本元素\n        return createTextVnode(text)\n    }\n    Vue.prototype._render = function() {\n        const vm = this;\n        const render = vm.$options.render;\n        let vnode = render.call(vm);\n        return vnode;\n    }\n}\nfunction createElement(tag,data={},...children) {\n    return vnode(tag,data,children)\n}\nfunction createTextVnode(text) {\n    return vnode(undefined,undefined,undefined,undefined,text)\n}\n// 用于产生虚拟dom，可以创建一些自定义属性\nfunction vnode(tag,data,key,children,text) {\n    return {\n        tag,\n        data,\n        key,\n        children,\n        text,\n    }\n}","import { initMixin } from \"./init\";\nimport { lifecycleMixin } from \"./lifecycle\";\nimport { renderMixin } from \"./vdom/index\";\n// 用vue的构造函数或者创建组件\nfunction Vue(options) {\n  this._init(options); // 组件初始化的入口\n}\n//写成一个个的插件进行扩展，解耦方法\n// vue初始化方法\ninitMixin(Vue); // init方法\nlifecycleMixin(Vue); // 混合生命周期，渲染dom _update\nrenderMixin(Vue) // _render\nexport default Vue;\n"],"names":["defaultTagRE","genProps","attrs","str","i","length","attr","name","obj","value","split","forEach","item","key","JSON","stringify","slice","gen","node","type","generate","text","test","tokens","lastIndex","match","index","exec","push","trim","join","getChildren","el","children","map","child","code","tag","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHTML","html","creatAstElement","tagName","parent","root","currentParent","stack","start","element","end","pop","chars","replace","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","advance","substring","n","compileToFunctions","template","ast","console","log","render","Function","patch","oldVnode","vnode","createElm","parentElm","parentNode","insertBefore","nextSibling","removeChild","data","document","createElement","appendChild","createTextNode","lifecycleMixin","Vue","prototype","_update","vm","$el","mountComponent","_render","proxy","Object","defineProperty","get","set","newValue","target","enumerable","configurable","oldArrayProtoMethods","Array","arrayMethods","create","methods","method","args","result","apply","arguments","inserted","ob","__ob__","observeArray","Observer","isArray","__proto__","walk","observe","keys","defineReactive","initSate","opts","$options","props","initData","computed","watch","_data","call","initMixin","_init","options","$mount","querySelector","outerHTML","renderMixin","_c","_s","val","_v","createTextVnode","undefined"],"mappings":"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"}