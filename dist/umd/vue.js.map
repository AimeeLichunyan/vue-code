{"version":3,"file":"vue.js","sources":["../../src/compiler/generate.js","../../src/compiler/parse.js","../../src/compiler/index.js","../../src/utils.js","../../src/observer/array.js","../../src/observer/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\n\n// dom结构转换成js语法\nfunction genProps(attrs) {\n    let str = '';\n    for(let i = 0; i < attrs.length; i++) {\n        let attr = attrs[i];\n        if(attr.name === 'style') {\n            let obj = {};\n            attr.value.split(';').forEach(item => {\n                let [key,value] = item.split(':');\n                obj[key] = value\n            })\n            attr.value = obj\n        }\n        str += `${attr.name} : ${JSON.stringify(attr.value)},`\n    }\n    return `{${str.slice(0,-1)}}`\n\n}\nfunction gen(node) {\n    if(node.type == 1) {\n        return generate(node) // 生成元素节点的字符串\n    } else {\n        let text = node.text\n        // 如果是普通文本，不带{{}}\n        if(!defaultTagRE.test(text)) {\n        return `_v(${JSON.stringify(text)})`\n\n        }\n        let tokens = [];\n        let lastIndex = defaultTagRE.lastIndex = 0\n        let match,index;\n        while(match = defaultTagRE.exec(text)) {\n            index = match.index; // 保存匹配到的索引\n            if(index > lastIndex) {\n                tokens.push(JSON.stringify(text.slice(lastIndex,index)))\n            }\n            tokens.push(`_s(${match[1].trim()})`);\n            lastIndex = index + match[0].length\n        }\n        if(lastIndex < text.length) {\n            tokens.push(JSON.stringify(text.slice(lastIndex)))\n        }\n        return `_v(${tokens.join('+')})`\n    }\n}\nfunction getChildren(el) {\n    const children = el.children;\n    if(children) { // 将所有转化后的儿子，用逗号拼接\n        return children.map(child => gen(child)).join(',')\n    }\n}\nexport function generate(el) {\n    let children = getChildren(el)\n    let code= `_c('${el.tag}',${el.attrs.length?`${genProps(el.attrs)}`: 'undefined'}${children?`,${children}`:''})`\n\n    return code\n}   ","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // 标签名，比如<aa-aa></aa-aa>\n// ?匹配不捕获 my:xx \nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`;\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 标签开头的正则 捕获的内容是标签名\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾的 </div>\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的 >\n\n\nexport function parseHTML(html) {\n\n    function creatAstElement(tagName,attrs) {\n        return {\n            tag: tagName,\n            children: [],\n            attrs,\n            type: 1, //类型，本文还是标签\n            parent: null,// 父级元素\n        }\n    }\n    let root;\n    let currentParent;\n    let stack = []\n    // 校验标签是否合法\n    function start(tagName,attrs) {\n        let element = creatAstElement(tagName,attrs)\n        if(!root) {\n            root = element\n        }\n        currentParent = element\n        stack.push(element)\n    }\n    function end(tagName) { // 在结尾标签处，创建父子关系\n        let element = stack.pop(); //取出栈中的最后一个元素\n        currentParent = stack[stack.length - 1];\n        if(currentParent) { // 在闭合时，知道这个标签的父级是哪个\n            element.parent = currentParent\n            currentParent.children.push(element)\n        }\n    }\n    function chars(text) {\n        text = text.replace(/\\s/g,\"\");\n        if(text) {\n            currentParent.children.push({\n                type:3,\n                text\n            })\n        }\n    }\n\n\n\n    while(html) { //只要html不为空，则一直解析\n        let textEnd = html.indexOf('<') // indexOf如果没有返回-1，如果有返回元素的位置\n        if(textEnd == 0) {\n            const startTagMatch =  parseStartTag(); //开始标签匹配的结果\n            if(startTagMatch) {\n                start(startTagMatch.tagName,startTagMatch.attrs)\n                continue\n            }\n            const endTagMatch =  html.match(endTag)\n            if(endTagMatch) {\n                advance(endTagMatch[0].length);\n                end(endTagMatch[1]) // 将结束标签传入\n                continue\n            }\n        }\n        let text;\n        if(textEnd > 0) {// 如果是文本\n            text = html.substring(0,textEnd);\n        }\n        if(text) {\n            advance(text.length)\n            chars(text);\n        }\n        // break\n    }\n    function advance(n) { // 将字符串进行截取操作，再更新html内容\n        html = html.substring(n)\n    }\n    function parseStartTag() {\n        const start = html.match(startTagOpen);\n        if(start) {\n            const match = {\n                tagName: start[1],\n                attrs: []\n            }\n            advance(start[0].length) // 删除开始标签\n            // 如果是闭合标签，说明没有属性\n            let end ;\n            let attr\n            // 不是结束标签，能匹配到属性\n            while(!(end=html.match(startTagClose)) && (attr = html.match(attribute))) {\n                match.attrs.push({name: attr[1],value:attr[3] || attr[4]|| attr[5]})\n                advance(attr[0].length)\n            }\n            if(end) {\n                advance(end[0].length);\n                return match\n            }\n            // console.log(html)\n        }\n    }\n\n    return root;\n}\n","import { generate } from \"./generate\"\n// <div id=\"my\">hello {{name}} <span>world</span> </div>\n// {\n//     tag: 'div',\n//     parent: null,\n//     type:1,\n//     attrs: [],\n//     children: [{\n//         tag:null,\n//         parent: div,父\n\nimport { parseHTML } from \"./parse\"\n\n//     }]\n// }\n\nexport function compileToFunctions(template) {\n    // console.log(template)\n    // 将html模板 =》 render函数\n    // ast语法树\n    // 1.将html代码转化成ast语法树，可以用ast树描述语言本身\n    // 前端必须掌握的数据结构===树\n    // 优化静态节点\n    let ast = parseHTML(template)\n    // 2. 优化静态节点\n    // console.log(ast)\n    // 3. 通过ast树重新生成代码\n    let code= generate(ast)\n    console.log(code)\n    // 4. 将字符串转换成函数,限制取值范围，通过with来进行取值。调用render函数可以通过改变this，让这个函数内部渠道结果\n   let render  =  new Function(`with(this){return ${code}}`)\n\n    // console.log(render)\n    return render\n    // 虚拟dom是用对象来描述节点，ast也可以描述js余元\n\n    \n}","export function proxy(vm,data,key) {\n    Object.defineProperty(vm,key,{\n      get() {\n        return vm[data][key];\n      },\n      set(newValue) {\n        vm[data][key] = newValue\n      }\n    })\n  }\n  export function defineProperty(target,key,value) {\n    Object.defineProperty(target,key,{\n        enumerable:false, // 不能被，枚举，不能被循环出来\n        configurable:false,\n        value: value\n      })\n  }","// 拿到数组原型的方法（或者拿到数组原来的方法）\nlet oldArrayProtoMethods = Array.prototype;\n\n// 继承原来数组的方法 arrayMethods.__proto__ = oldArrayProtoMethods,继承以后可以重写，如果没有重写，则会顺着原型链找到原来数组的方法\nexport let arrayMethods = Object.create(oldArrayProtoMethods)\nlet methods = [\n    'push',\n    'pop',\n    'shift',\n    'unshift',\n    'reverse',\n    'sort',\n    'splice'\n]\n// 这是个高阶函数或者叫切片编程\nmethods.forEach(method => {\n    arrayMethods[method] = function(...args) { // this就是ob\n        const result = oldArrayProtoMethods[method].apply(this,arguments)\n        let inserted;\n        let ob = this.__ob__\n        switch (method) {\n            case 'push': // arr.push({a:1},{b:2})\n            case 'unshift': // push和unshift方法都是追加的,追加的内容可能是对象类型，应该再次进行劫持\n                inserted = args\n                break;\n            case 'splice': // vue.$set实现的原理就是splice，删除，添加，修改\n            inserted = args.slice(2) // arr.splice(0,1,{a:1})\n            default:\n                break;\n        }\n        if(inserted) ob.observeArray(inserted) // 给数组新增的值进行观测\n        return result\n    }\n})","import { defineProperty } from \"../utils\";\nimport { arrayMethods } from \"./array\";\n\n// 数据观测的方法\nclass Observer {\n  constructor(value) {\n    // 使用defineProperty重新定义属性，\n    // 判断一个对象是否被观测过，看它有没有__ob__这个属性\n    defineProperty(value,'__ob__',this)\n    \n    // 判断是否是数组\n    if(Array.isArray(value)) {\n      // 调用push，shift，unshift,splice,sort,reverse,pop等操作\n      // 函数劫持，或者切片编程\n      value.__proto__ = arrayMethods\n      // 观测数组中的对象类型，对象变化触发一些操作\n      this.observeArray(value)\n    }else {\n      //   使用defineProperty 重新定义属性\n    this.walk(value);\n    }\n    \n  }\n  observeArray(value) {\n    value.forEach(item => {\n      observe(item)\n    })\n  }\n  walk(data) {\n    let keys = Object.keys(data);\n    keys.forEach((key) => {\n      defineReactive(data, key, data[key]); // Vue.utils.defineReactive\n    });\n  }\n}\nfunction defineReactive(data, key, value) {// 为每一个对象添加defineProperty，getset函数，进行数据劫持\n  observe(value) // 递归进行检测，value是否是对象，只要对象层级比较深，就会不停的递归，影响性能，所以在vue3中使用proxy实现，vue3是懒递归\n  Object.defineProperty(data, key, { // 其实是一个闭包，当前作用域下data不销毁\n    get() {\n      console.log('q取值')\n      return value;\n    },\n    set(newValue) {\n      console.log('设置')\n      if (newValue == value) return; // 如果新值和老值一样则不赋值操作\n      observe(newValue) // 判断设置的新的值是不是对象，如果用户将值改为对象，则继续监控\n      value = newValue;\n    },\n  });\n}\nexport default function observe(data) {\n  if (typeof data !== \"object\" || data === null) {\n    return data;\n  }\n  if(data.__ob__) {\n    return data;\n  }\n  return new Observer(data);\n}\n","import observe from \"./observer/index.js\";\nimport { proxy } from \"./utils.js\";\n\n// 状态的初始化;\nexport function initSate(vm) {\n  // vue初始化的顺序就是：先初始化属性，在是方法，再是data\n  const opts = vm.$options;\n  if (opts.props) {\n    initProps(vm);\n  }\n  if (opts.methods) {\n    initMethods(vm);\n  }\n  //   核心部分\n  if (opts.data) {\n    initData(vm);\n  }\n  if (opts.computed) {\n    initComputed(vm);\n  }\n  if (opts.watch) {\n    initWatch(vm);\n  }\n}\nfunction initProps() {}\nfunction initMethods() {}\n\nfunction initData(vm) {\n  let data = vm.$options.data;\n  vm._data = data = typeof data == \"function\" ? data.call(vm) : data;\n  //   数据的劫持方案： 对象object.defineProperty\n  // 数组会单独处理\n\n  // 实现代理 -- 当我去vm上取值是，帮我将属性的取值代理大vm._data上\n  for(let key in data) {\n    proxy(vm,'_data',key)\n  }\n  observe(data);\n}\nfunction initComputed() {}\nfunction initWatch() {}\n","import { compileToFunctions } from \"./compiler/index\";\nimport { initSate } from \"./state\";\n\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    const vm = this;\n    vm.$options = options;\n\n    // 初始化状态（数据做初始化劫持，改变数据时应该更新视图）\n    //  vue 组件中很多状态，data,props,watch,computed\n    initSate(vm);\n\n    // vue核心特性：响应式数据原理\n    // Vue 是什么框架，MVVM（不完全是）怎么是？ 数据变化视图会更新，视图变化数据会被影响，\n    // 怎么不是？ mvvm不能跳过数据直接更新视图，但是vue有$ref可以直接操作dom\n    // 如果有el属性，说明要渲染模板\n    if(vm.$options.el) {\n      vm.$mount(vm.$options.el)\n    }\n  };\n  Vue.prototype.$mount = function(el) {\n    // 挂载操作\n    const vm = this;\n    const options = vm.$options;\n\n    el = document.querySelector(el);\n    if(!options.render) {\n      // 没有render方法，将template转化成render方法\n      let template = options.template;\n      if(!template && el) { // 没有tamplatet，有el，直接采用外部模板，即我们平时的写法\n        template = el.outerHTML; // el.outerHTML拿到el所在的html元素\n      }\n      // 编译原理，将模板编译成render函数\n      const render = compileToFunctions(template); // 将dom结构编译成函数\n      // options.render = render\n    }\n    // console.log(options.render) // 渲染时用的都是这个render方法\n\n  }\n}\n","import { initMixin } from \"./init\";\nfunction Vue(options) {\n  console.log(options);\n  this._init(options);\n}\n//写成一个个的插件进行扩展，解耦方法\n// vue初始化方法\ninitMixin(Vue);\nexport default Vue;\n"],"names":["defaultTagRE","genProps","attrs","str","i","length","attr","name","obj","value","split","forEach","item","key","JSON","stringify","slice","gen","node","type","generate","text","test","tokens","lastIndex","match","index","exec","push","trim","join","getChildren","el","children","map","child","code","tag","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHTML","html","creatAstElement","tagName","parent","root","currentParent","stack","start","element","end","pop","chars","replace","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","advance","substring","n","compileToFunctions","template","ast","console","log","render","Function","proxy","vm","data","Object","defineProperty","get","set","newValue","target","enumerable","configurable","oldArrayProtoMethods","Array","prototype","arrayMethods","create","methods","method","args","result","apply","arguments","inserted","ob","__ob__","observeArray","Observer","isArray","__proto__","walk","observe","keys","defineReactive","initSate","opts","$options","props","initData","computed","watch","_data","call","initMixin","Vue","_init","options","$mount","document","querySelector","outerHTML"],"mappings":"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"}